from collections import defaultdict
import numpy as np
website_reliability_map = {
    "Cosmopolitan": (24.22,-13.11),
    "The Washington Free Beacon": (24.05,14.17),
    "Bill OReilly": (24.16,20.90),
    "Daily Dot": (25.56,-9.74),
    "Townhall": (25.13,19.45),
    "The Root": (26.51,-18.47),
    "Daily Kos": (26.75,-17.70),
    "Media Matters for America": (26.45,-15.06),
    "Rolling Stone": (26.24,-13.76),
    "Mirror - UK": (26.88,-3.41),
    "Independent Journal Review | IJR": (26.13,12.66),
    "RealClearPolitics": (26.90,14.45),
    "Published Reporter": (26.86,15.48),
    "Right Wing Watch | People For the American Way": (27.23,-18.22),
    "Rebel News": (27.12,12.09),
    "OutKick": (27.30,13.72),
    "Jezebel": (28.55,-18.25),
    "RT Russia Today": (28.71,11.44),
    "The Spectator World": (28.42,12.66),
    "Newsmax (website)": (28.14,13.42),
    "OAN Network (website)": (28.56,14.00),
    "Heritage Foundation": (28.68,15.96),
    "The Nation": (30.81,-18.98),
    "New Republic": (30.03,-16.63),
    "Daily Mail": (30.80,4.61),
    "Breitbart": (30.40,13.57),
    "Blaze Media": (30.18,13.58),
    "Democracy Now! (website)": (31.68,-16.15),
    "Daily Beast": (31.22,-10.77),
    "New York Post": (31.35,9.37),
    "The Post Millennial": (31.43,12.14),
    "New York Sun": (31.50,12.84),
    "National Review": (31.32,12.73),
    "Daily Wire": (31.11,13.12),
    "The American Conservative": (31.64,14.36),
    "Salon": (32.93,-13.67),
    "Hill Reporter": (32.56,-13.11),
    "Blavity News": (32.61,-12.25),
    "Inquisitr": (32.92,-7.24),
    "Just the News": (32.56,10.90),
    "National Catholic Register": (32.13,11.62),
    "In These Times": (33.27,-18.09),
    "Truthout": (33.35,-16.87),
    "Vanity Fair": (33.34,-13.95),
    "Raw Story": (33.99,-13.72),
    "Washington Times": (33.46,11.59),
    "CBN": (34.00,15.23),
    "MS NOW | MSNBC (website)": (34.52,-13.89),
    "Mediaite": (34.41,-8.85),
    "The Bulwark": (34.17,-4.63),
    "TMZ": (34.73,-4.30),
    "The Epoch Times": (34.45,8.14),
    "The College Fix": (34.39,10.31),
    "Fox News (website)": (34.91,11.11),
    "Washington Examiner": (34.06,11.21),
    "Daily Caller": (34.43,12.74),
    "Rasmussen Reports": (34.05,13.78),
    "Mother Jones": (35.61,-15.12),
    "Slate": (35.29,-12.74),
    "AlterNet": (35.81,-12.41),
    "Washington Monthly": (35.78,-12.08),
    "Talking Points Memo - John Marshall": (35.81,-11.79),
    "Reason": (35.79,4.21),
    "City Journal": (35.00,10.21),
    "The Lever - David Sirota": (36.18,-17.42),
    "Newser": (36.83,-5.52),
    "Fortune": (36.91,-2.79),
    "Boston Herald": (36.31,9.68),
    "The Christian Post": (36.16,10.65),
    "Common Dreams": (37.41,-17.07),
    "Teen Vogue": (37.79,-15.50),
    "The Intercept": (37.39,-14.02),
    "WIRED": (37.13,-7.19),
    "Quillette": (37.53,9.27),
    "American Independent": (38.38,-14.61),
    "HuffPost": (38.06,-10.67),
    "The Week": (38.39,-10.69),
    "The Atlantic": (38.04,-9.33),
    "The Verge": (38.10,-7.27),
    "The Independent": (38.49,-6.91),
    "Washington Post": (38.67,-7.13),
    "Fox Business (website)": (38.66,9.04),
    "Advocate Magazine": (39.45,-12.43),
    "Vogue": (39.13,-10.91),
    "TheGrio": (39.55,-10.82),
    "Vox": (39.65,-9.98),
    "Miami Herald": (39.02,-8.07),
    "Upworthy": (39.86,-5.57),
    "Newsweek": (39.14,-1.78),
    "Straight Arrow News": (39.89,0.83),
    "The New Yorker": (40.85,-12.48),
    "The Guardian": (40.18,-8.10),
    "Forward": (40.45,-7.37),
    "The New York Times": (40.97,-8.07),
    "Business Insider": (40.61,-4.01),
    "MarketWatch": (40.93,-3.88),
    "USA Today": (40.91,-3.77),
    "Forbes": (40.70,-2.88),
    "CNET": (40.02,-1.39),
    "American Action Forum": (40.28,2.00),
    "Deseret News": (40.70,2.11),
    "The Center Square": (40.32,3.81),
    "Orange County Register": (40.58,5.43),
    "Time Magazine": (41.07,-7.40),
    "Al Jazeera (website)": (41.29,-7.30),
    "Boston Globe": (41.94,-7.85),
    "Poynter": (41.75,-7.32),
    "People Magazine": (41.58,-5.53),
    "CBS News (website)": (41.90,-3.07),
    "The Economist": (41.67,-2.90),
    "The Hill": (41.65,-1.51),
    "Sky News": (41.77,-0.76),
    "Christianity Today": (41.75,5.39),
    "The Dispatch": (41.08,5.50),
    "World News Group": (41.51,7.28),
    "CNN (website)": (42.10,-6.23),
    "LA Times": (42.76,-6.27),
    "NBC News (website)": (42.74,-5.60),
    "Politico": (42.31,-5.44),
    "Foreign Policy": (42.63,-4.05),
    "Bloomberg News": (42.24,-3.04),
    "NewsNation (website)": (42.94,0.54),
    "Foreign Affairs": (43.54,-7.01),
    "Columbia Journalism Review": (43.33,-6.26),
    "Detroit Free Press": (43.46,-5.43),
    "NPR (website)": (43.09,-4.32),
    "PBS": (43.30,-4.33),
    "Fiscal Times": (43.33,-4.18),
    "Axios": (43.10,-3.27),
    "US News and World Report": (43.55,-3.01),
    "Scripps News (website)": (43.59,-2.03),
    "Dallas Morning News": (43.65,-1.91),
    "CNBC (website)": (43.75,-1.95),
    "The Globe and Mail": (43.99,-1.14),
    "Tangle": (43.04,1.58),
    "Wall Street Journal": (43.30,4.15),
    "Financial Times": (44.00,-3.98),
    "Politifact": (44.67,-3.54),
    "ABC News (website)": (44.54,-3.12),
    "AP | Associated Press": (44.80,-2.46),
    "Christian Science Monitor": (44.23,-2.52),
    "BBC": (44.66,-1.34),
    "Barrons": (44.78,-0.39),
    "Reuters": (45.00,-1.32),
    "The Marshall Project": (45.76,-6.46),
    "Chicago Sun-Times": (45.44,-4.35),
    "11Alive Atlanta NBC WXIA": (45.75,-3.86),
    "UPI": (45.32,-1.11),
    "Arkansas Democrat-Gazette": (45.14,0.18),
    "Patch": (46.09,-3.54),
    "The Weather Channel": (46.20,-1.85),
    "Newsday": (46.71,-3.51),
    "BNO News": (46.37,-0.40),
    "Chron.com": (46.63,-0.60),
    "Air Force Times": (46.01,1.18),
    "ProPublica": (47.22,-6.82),
    "Agence France-Presse | AFP": (47.15,-2.40),
    "USAFacts": (50.32,-0.07)
}
class SentenceIndexer:
    def __init__(self):
        self.index = defaultdict(list)

    def load_from_file(self, filepath):
        try:
            with open(filepath, 'r', encoding='utf-8') as f:
                for line in f:
                    line = line.strip()
                    if not line: continue
                    parts = line.split(',')
                    if len(parts) < 2: continue
                    source_name = parts[0].strip()
                    raw_sentences = parts[1:]
                    clean_sentences = [s.strip() for s in raw_sentences if s.strip()]
                    self._add_to_index(source_name, clean_sentences)

            print(f"Successfully loaded and indexed data from {filepath}")

        except FileNotFoundError:
            print(f"Error: Could not find file {filepath}")

    def _add_to_index(self, source, sentences):
        unique_sentences = set(sentences)
        for sentence in unique_sentences:
            self.index[sentence].append(source)

    def search(self, query_sentence):
        query_sentence = query_sentence.strip()

        if query_sentence in self.index:
            sources = self.index[query_sentence]
            return {
                "sentence": query_sentence,
                "frequency": len(sources),
                "sources appeared in": sources
            }
        else:
            return f"Sentence not found: '{query_sentence}'"

if __name__ == "__main__":
    indexer = SentenceIndexer()
    indexer.load_from_file("temp.txt") # Reads a text file where each line is: Source website, concatenated triple sentence 1,), concatenated triple sentence 2...

    query = "Relatively robust U.S. data supported sentiment in equity markets"
    retrieved = indexer.search(query)
    print(retrieved)

reliability_map = {
    "Cosmopolitan": (24.22,-13.11),
    "The Washington Free Beacon": (24.05,14.17),
    "Bill OReilly": (24.16,20.90),
    "Daily Dot": (25.56,-9.74),
    "Townhall": (25.13,19.45),
    "The Root": (26.51,-18.47),
    "Daily Kos": (26.75,-17.70),
    "Media Matters for America": (26.45,-15.06),
    "Rolling Stone": (26.24,-13.76),
    "Mirror - UK": (26.88,-3.41),
    "Independent Journal Review | IJR": (26.13,12.66),
    "RealClearPolitics": (26.90,14.45),
    "Published Reporter": (26.86,15.48),
    "Right Wing Watch | People For the American Way": (27.23,-18.22),
    "Rebel News": (27.12,12.09),
    "OutKick": (27.30,13.72),
    "Jezebel": (28.55,-18.25),
    "RT Russia Today": (28.71,11.44),
    "The Spectator World": (28.42,12.66),
    "Newsmax (website)": (28.14,13.42),
    "OAN Network (website)": (28.56,14.00),
    "Heritage Foundation": (28.68,15.96),
    "The Nation": (30.81,-18.98),
    "New Republic": (30.03,-16.63),
    "Daily Mail": (30.80,4.61),
    "Breitbart": (30.40,13.57),
    "Blaze Media": (30.18,13.58),
    "Democracy Now! (website)": (31.68,-16.15),
    "Daily Beast": (31.22,-10.77),
    "New York Post": (31.35,9.37),
    "The Post Millennial": (31.43,12.14),
    "New York Sun": (31.50,12.84),
    "National Review": (31.32,12.73),
    "Daily Wire": (31.11,13.12),
    "The American Conservative": (31.64,14.36),
    "Salon": (32.93,-13.67),
    "Hill Reporter": (32.56,-13.11),
    "Blavity News": (32.61,-12.25),
    "Inquisitr": (32.92,-7.24),
    "Just the News": (32.56,10.90),
    "National Catholic Register": (32.13,11.62),
    "In These Times": (33.27,-18.09),
    "Truthout": (33.35,-16.87),
    "Vanity Fair": (33.34,-13.95),
    "Raw Story": (33.99,-13.72),
    "Washington Times": (33.46,11.59),
    "CBN": (34.00,15.23),
    "MS NOW | MSNBC (website)": (34.52,-13.89),
    "Mediaite": (34.41,-8.85),
    "The Bulwark": (34.17,-4.63),
    "TMZ": (34.73,-4.30),
    "The Epoch Times": (34.45,8.14),
    "The College Fix": (34.39,10.31),
    "Fox News (website)": (34.91,11.11),
    "Washington Examiner": (34.06,11.21),
    "Daily Caller": (34.43,12.74),
    "Rasmussen Reports": (34.05,13.78),
    "Mother Jones": (35.61,-15.12),
    "Slate": (35.29,-12.74),
    "AlterNet": (35.81,-12.41),
    "Washington Monthly": (35.78,-12.08),
    "Talking Points Memo - John Marshall": (35.81,-11.79),
    "Reason": (35.79,4.21),
    "City Journal": (35.00,10.21),
    "The Lever - David Sirota": (36.18,-17.42),
    "Newser": (36.83,-5.52),
    "Fortune": (36.91,-2.79),
    "Boston Herald": (36.31,9.68),
    "The Christian Post": (36.16,10.65),
    "Common Dreams": (37.41,-17.07),
    "Teen Vogue": (37.79,-15.50),
    "The Intercept": (37.39,-14.02),
    "WIRED": (37.13,-7.19),
    "Quillette": (37.53,9.27),
    "American Independent": (38.38,-14.61),
    "HuffPost": (38.06,-10.67),
    "The Week": (38.39,-10.69),
    "The Atlantic": (38.04,-9.33),
    "The Verge": (38.10,-7.27),
    "The Independent": (38.49,-6.91),
    "Washington Post": (38.67,-7.13),
    "Fox Business (website)": (38.66,9.04),
    "Advocate Magazine": (39.45,-12.43),
    "Vogue": (39.13,-10.91),
    "TheGrio": (39.55,-10.82),
    "Vox": (39.65,-9.98),
    "Miami Herald": (39.02,-8.07),
    "Upworthy": (39.86,-5.57),
    "Newsweek": (39.14,-1.78),
    "Straight Arrow News": (39.89,0.83),
    "The New Yorker": (40.85,-12.48),
    "The Guardian": (40.18,-8.10),
    "Forward": (40.45,-7.37),
    "The New York Times": (40.97,-8.07),
    "Business Insider": (40.61,-4.01),
    "MarketWatch": (40.93,-3.88),
    "USA Today": (40.91,-3.77),
    "Forbes": (40.70,-2.88),
    "CNET": (40.02,-1.39),
    "American Action Forum": (40.28,2.00),
    "Deseret News": (40.70,2.11),
    "The Center Square": (40.32,3.81),
    "Orange County Register": (40.58,5.43),
    "Time Magazine": (41.07,-7.40),
    "Al Jazeera (website)": (41.29,-7.30),
    "Boston Globe": (41.94,-7.85),
    "Poynter": (41.75,-7.32),
    "People Magazine": (41.58,-5.53),
    "CBS News (website)": (41.90,-3.07),
    "The Economist": (41.67,-2.90),
    "The Hill": (41.65,-1.51),
    "Sky News": (41.77,-0.76),
    "Christianity Today": (41.75,5.39),
    "The Dispatch": (41.08,5.50),
    "World News Group": (41.51,7.28),
    "CNN (website)": (42.10,-6.23),
    "LA Times": (42.76,-6.27),
    "NBC News (website)": (42.74,-5.60),
    "Politico": (42.31,-5.44),
    "Foreign Policy": (42.63,-4.05),
    "Bloomberg News": (42.24,-3.04),
    "NewsNation (website)": (42.94,0.54),
    "Foreign Affairs": (43.54,-7.01),
    "Columbia Journalism Review": (43.33,-6.26),
    "Detroit Free Press": (43.46,-5.43),
    "NPR (website)": (43.09,-4.32),
    "PBS": (43.30,-4.33),
    "Fiscal Times": (43.33,-4.18),
    "Axios": (43.10,-3.27),
    "US News and World Report": (43.55,-3.01),
    "Scripps News (website)": (43.59,-2.03),
    "Dallas Morning News": (43.65,-1.91),
    "CNBC (website)": (43.75,-1.95),
    "The Globe and Mail": (43.99,-1.14),
    "Tangle": (43.04,1.58),
    "Wall Street Journal": (43.30,4.15),
    "Financial Times": (44.00,-3.98),
    "Politifact": (44.67,-3.54),
    "ABC News (website)": (44.54,-3.12),
    "AP | Associated Press": (44.80,-2.46),
    "Christian Science Monitor": (44.23,-2.52),
    "BBC": (44.66,-1.34),
    "Barrons": (44.78,-0.39),
    "Reuters": (45.00,-1.32),
    "The Marshall Project": (45.76,-6.46),
    "Chicago Sun-Times": (45.44,-4.35),
    "11Alive Atlanta NBC WXIA": (45.75,-3.86),
    "UPI": (45.32,-1.11),
    "Arkansas Democrat-Gazette": (45.14,0.18),
    "Patch": (46.09,-3.54),
    "The Weather Channel": (46.20,-1.85),
    "Newsday": (46.71,-3.51),
    "BNO News": (46.37,-0.40),
    "Chron.com": (46.63,-0.60),
    "Air Force Times": (46.01,1.18),
    "ProPublica": (47.22,-6.82),
    "Agence France-Presse | AFP": (47.15,-2.40),
    "USAFacts": (50.32,-0.07)
}

keys = list(reliability_map.keys())
v1 = np.array([reliability_map[k][0] for k in keys])
v2 = np.array([reliability_map[k][1] for k in keys])

norm1 = np.linalg.norm(v1)
norm2 = np.linalg.norm(v2)

v1_normalized = v1 / norm1
v2_normalized = v2 / norm2

normalized_reliability_map = {}
for i, key in enumerate(keys):
    normalized_reliability_map[key] = (v1_normalized[i], v2_normalized[i])

for key, val in normalized_reliability_map.items():
    print(f"'{key}': {val},")

for source in retrieved["sources appeared in"]:
    print(reliability_map[source])